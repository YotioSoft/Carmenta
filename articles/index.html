<!DOCUTYPE HTML>
<html lang="ja">
  <head>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-174934210-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-174934210-1');
    </script>

    <meta charset="utf8">
    <link rel="stylesheet" href="../style.css">
    <link rel="stylesheet" href="../buttons.css">
    <link rel="stylesheet" href="../header.css">
    <link rel="stylesheet" href="../headings.css">
    <link rel="stylesheet" href="../card.css">
    <link rel="stylesheet" href="../badges.css">
    <link rel="icon" type="image/png" href="/img/logo/yotiosoft32.png">
    <title>お知らせ - YotioSoft</title>

    <script src="../js/jquery-3.5.1.min.js"></script>
    <script src="../js/common.js"></script>
    <script src="../js/side.js"></script>
    <script src="../js/jump.js"></script>
    <script src="./load_article.js"></script>
  </head>

  <body>
    <div id="wrap">
      <header>
        <div id="headers">
          <div id="header_fixed">
            <div id="header"></div>
          </div>
        </div>
      </header>

      <div style="margin-top: 100px;"></div>

      <div class="pageheader" id="pegeheader_id" style="background: #e67e22;">
        <div class="pageheader_wrap">
          <div class="pageheader_title">お知らせ</div>
          <div class="pageheader_summary">YotioSoftからのお知らせなど。</div>
        </div>
      </div>

      <nav>
        <div class="navibar_wrap">
          <div class="navibar">
            <a href="/">Home</a>
            <font class="arrow">></font>
            お知らせ
          </div>
        </div>
      </nav>

      <div class="main_wrap">
        <div id="sidebar">
          <div id="sticked">
            <div id="sidebar_menu">
              <div id="sidebar_h">
                お知らせ
              </div>
              <div id="sidebar_links">
                <li><a href="#articles">最近の投稿</a></li>
              </div>
            </div>
          </div>
        </div>

        <div id="content">
        	<div class="column">
            <div id="articles"></div>
            
            <div class="inline-heading-wrap">
              <div class="inline-heading-en" style="color:#e67e22;">Recently Posts</div>
              <div class="inline-heading-jp">最近の投稿</div>
            </div>
            
            <div id="articles_wrap" class="blockcards_wrap">

            </div>

            <script>
              const formatter = new Intl.NumberFormat('ja', {
                minimumIntegerDigits: 2, 
                useGrouping: false
              });
              
              var articles_wrap = document.getElementById("articles_wrap");

              $.getJSON("articles.json", function(data){
                for (let i=0; i<data.length; i++) {
                  /* カードを追加 */
                  var e_blockcard = document.createElement('div');
                  e_blockcard.className = 'blockcard';
                  
                  var e_blockcard_link = document.createElement('a');
                  e_blockcard_link.id = 'blockcard_link';

                  var e_blockcard_image_wrap = document.createElement('blockcard_image_wrap');
                  e_blockcard_image_wrap.className = 'blockcard_image_wrap';

                  var e_blockcard_image = document.createElement('img');
                  e_blockcard_image.className = 'blockcard_image';
                  e_blockcard_image_wrap.appendChild(e_blockcard_image);
                  e_blockcard_link.appendChild(e_blockcard_image_wrap);
                  e_blockcard.appendChild(e_blockcard_link);

                  var e_blockcard_absolute = document.createElement('div');
                  e_blockcard_absolute.className = 'blockcard_absolute';

                  var e_blockcard_title = document.createElement('p');
                  e_blockcard_title.className = 'blockcard_title';
                  e_blockcard_title.id = 'blockcard_title_id';
                  e_blockcard_absolute.appendChild(e_blockcard_title);

                  var e_blockcard_tags = document.createElement('p');
                  e_blockcard_tags.className = 'blockcard_tags';
                  e_blockcard_tags.id = 'blockcard_tags_id';
                  e_blockcard_absolute.appendChild(e_blockcard_tags);

                  var e_blockcard_content = document.createElement('p');
                  e_blockcard_content.className = 'blockcard_content';
                  e_blockcard_content.id = 'blockcard_content_id';
                  e_blockcard_absolute.appendChild(e_blockcard_content);

                  var e_blockcard_button_wrap = document.createElement('span');
                  e_blockcard_button_wrap.className = 'blockcard_button_wrap';

                  var e_blockcard_button = document.createElement('span');
                  e_blockcard_button.className = 'blockcard_button';

                  var e_readmore_button = document.createElement('a');
                  e_readmore_button.className = 'readmore_button';
                  e_readmore_button.style = 'color:#fff;" id="blockcard_read_button';
                  e_readmore_button.textContent = '詳しく見る';
                  e_blockcard_button.appendChild(e_readmore_button);
                  e_blockcard_button_wrap.appendChild(e_blockcard_button);
                  e_blockcard_absolute.appendChild(e_blockcard_button_wrap);
                  e_blockcard.appendChild(e_blockcard_absolute);

                  articles_wrap.appendChild(e_blockcard);

/*
                  articles.insertAdjacentHTML('beforeend', '\
                  <div class="blockcard"> \
                    <a id="blockcard_link"> \
                      <div class="blockcard_image_wrap"> \
                        <img src="../img/articles/2020/58BC5481-3245-477C-98FF-94DAAA00C453.jpeg" class="blockcard_image"> \
                      </div> \
                    </a> \
                    <div class="blockcard_absolute"> \
                      <p class="blockcard_title" id="blockcard_title_id"></p> \
                      <p class="blockcard_tags" id="blockcard_tags_id"></p> \
                      <p class="blockcard_content" id="blockcard_content_id"></p> \
                      \
                      <span class="blockcard_button_wrap"> \
                        <span class="blockcard_button"> \
                          <a class="readmore_button" style="color:#fff;" id="blockcard_read_button">詳しく見る</a> \
                        </span> \
                      </span> \
                    </div> \
                  </div> \
                  ');*/

                  /* データ代入 */
                  e_blockcard_link.href = data[i].link;
                  e_readmore_button.href = data[i].link;
                  e_blockcard_image.src = data[i].image;
                  e_blockcard_content.textContent = "読み込み中...";

                  const doc = fetch(data[i].link)
                  .then((res) => res.text())
                  .then((text) => {
                      return new DOMParser().parseFromString(text, "text/html");
                    })
                  .then((doc) => {
                    e_blockcard_content.innerHTML = data[i].year+"."+formatter.format(data[i].month)+"."+formatter.format(data[i].day)+"<br>"
                      +doc.getElementById("article_summary").innerText;
                    e_blockcard_tags.innerHTML = doc.getElementById("article_tags").innerHTML;
                    e_blockcard_title.innerHTML = doc.getElementById("article_title").innerText;
                  }
                  );
                }
              });
            </script>
            <!--
            <div class="blockcard">
              <a id="blockcard_link">
                <div class="blockcard_image_wrap">
                  <img src="../img/articles/2020/58BC5481-3245-477C-98FF-94DAAA00C453.jpeg" class="blockcard_image">
                </div>
              </a>
              <div class="blockcard_absolute">
                <p class="blockcard_title" id="blockcard_title_id"></p>
                <p class="blockcard_tags" id="blockcard_tags_id"></p>
                <p class="blockcard_content" id="blockcard_content_id"></p>

                <span class="blockcard_button_wrap">
                  <span class="blockcard_button">
                    <a class="readmore_button" style="color:#fff;" id="blockcard_read_button">詳しく見る</a>
                  </span>
                </span>
              </div>
            </div>
            -->
        	</div>
        </div>
      </div>

      <footer class="footer_class">
        <div id="footer"></div>
      </footer>
    </div>
  </body>

</html>
